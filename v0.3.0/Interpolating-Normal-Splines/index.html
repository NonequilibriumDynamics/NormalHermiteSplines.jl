<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interpolating Normal Splines · NormalHermiteSplines.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NormalHermiteSplines.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Public-API/">Public API</a></li><li><a class="tocitem" href="../Usage/">Example Usage</a></li><li><a class="tocitem" href="../Parameter-Choice/">Choice of the scaling parameter</a></li><li><a class="tocitem" href="../Numerical-Tests/">Numerical Tests</a></li><li><a class="tocitem" href="../Tests-with-real-data/">Tests with real data</a></li><li><a class="tocitem" href="../Normal-Splines-Method/">Normal Splines Method</a></li><li><a class="tocitem" href="../Riesz-representers/">The Riesz representation of functionals and a reproducing kernel Hilbert space</a></li><li><a class="tocitem" href="../Reproducing-Kernel-of-Bessel-Potential-space/">Reproducing Kernel of Bessel Potential space</a></li><li class="is-active"><a class="tocitem" href>Interpolating Normal Splines</a></li><li><a class="tocitem" href="../Simple-examples/">Simple Normal Splines Examples</a></li><li><a class="tocitem" href="../Relation-to-Polyharmonic-Splines/">Relation to Polyharmonic Splines</a></li><li><a class="tocitem" href="../Updating-Cholesky-Factorization/">Updating Cholesky Factorization</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interpolating Normal Splines</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interpolating Normal Splines</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/IgorKohan/NormalHermiteSplines.jl/blob/master/docs/src/Interpolating-Normal-Splines.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Interpolating-Normal-Splines"><a class="docs-heading-anchor" href="#Interpolating-Normal-Splines">Interpolating Normal Splines</a><a id="Interpolating-Normal-Splines-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolating-Normal-Splines" title="Permalink"></a></h1><p>Consider the following interpolation problem:</p><p><em>Problem:</em> Given points <span>$\{p_i, p_i \in R^n\}_{i=1}^{n_1}$</span>, <span>$\{s_j, s_j \in R^n\}_{j=1}^{n_2}$</span> and a set of unit vectors <span>$\{e_j, e_j \in R^n\}_{j=1}^{n_2}$</span> find a function <span>$f$</span> such that</p><div>\[\tag{1}
\begin{aligned}
&amp; f(p_i) =  u_i \, , \quad  i = 1, 2, \dots, n_1 \, ,
\\  
&amp; \frac{ \partial{f} }{ \partial{e_j} }(s_j) =  v_j \, , \quad  j = 1, 2, \dots, n_2 \, ,
\\
&amp; n_1 \gt 0 \, ,  \ \  n_2 \ge 0 \, .
\end{aligned}\]</div><p>where <span>$\frac{ \partial{f} }{ \partial{e_j} }(s_j) = \nabla f(s_j) \cdot e_j = \sum _{k=1}^{n}  \frac{ \partial{f} }{ \partial{x_k} } (s_j) e_{jk}$</span> is a directional derivative of <span>$f$</span> at the point <span>$s_j$</span> in the direction of <span>$e_j$</span>.</p><p>We assume that function <span>$f$</span> is an element of the Bessel Potential space <span>$H^s_\varepsilon (R^n)$</span> which is defined as:</p><div>\[   H^s_\varepsilon (R^n) = \left\{ \varphi | \varphi \in S&#39; ,
  ( \varepsilon ^2 + | \xi |^2 )^{s/2}{\mathcal F} [\varphi(\xi)] \in L_2 (R^n) \right\} , \quad
  \varepsilon \gt 0 , \ \ s = n/2 + 1/2 + r \, , \quad r = 1,2,\dots \, .\]</div><p>where <span>$| \cdot |$</span> is the Euclidean norm, <span>$S&#39;  (R^n)$</span> is space of L. Schwartz tempered distributions, parameter <span>$s$</span> may be treated as a fractional differentiation order and <span>$\mathcal F [\varphi ]$</span> is a Fourier transform of the <span>$\varphi$</span>. The parameter <span>$\varepsilon$</span> can be considered as a &quot;scaling parameter&quot;, it allows to control approximation properties of the normal spline which usually are getting better with smaller values of <span>$\varepsilon$</span>, also it can be used to reduce the ill-conditioness of the related computational problem (in traditional theory <span>$\varepsilon = 1$</span>).</p><p>Theoretical properties of spaces <span>$H^s_\varepsilon$</span> at <span>$\varepsilon \gt 0$</span> are identical — they are Hilbert spaces with inner product</p><div>\[\langle \varphi , \psi \rangle =
\int ( \varepsilon ^2  + | \xi |^2 )^s
\mathcal F [\varphi(\xi) ] \overline{\mathcal F [\psi(\xi) ] } \, d \xi\]</div><p>and  norm</p><div>\[\| \varphi \| = \left( \int ( \varepsilon ^2  + | \xi |^2 )^s
\mathcal | {\mathcal F} [\varphi(\xi) ] |^2  \, d \xi \ 
 \right)^{1/2} \ .\]</div><p>It is easy to see that all these norms are equivalent. It means that space <span>$H^s_\varepsilon (R^n)$</span> is equivalent to <span>$H^s (R^n) =  H^s_1 (R^n)$</span>.</p><p>Obviously, <span>$\| \varphi \|_ {H^s_\varepsilon} \le \| \varphi \|_ {H^t_\varepsilon}$</span> if <span>$s &lt; t$</span>, so that the space with larger index is continuously embedded in the space with smaller index. The space <span>$H^0_\varepsilon (R^n)$</span> coincides with <span>$L_2 (R^n)$</span> in view of Parseval’s identity</p><div>\[ \int \mathcal | {\mathcal F} [\varphi ] |^2  \, d \xi \ = \int \mathcal |\varphi|^2  \, dx   \]</div><p>and the norms on these spaces coincide. Therefore, all spaces <span>$H^s_\varepsilon (R^n)$</span> with nonnegative <span>$s$</span> consist of usual square integrable (i.e., having integrable square of absolute value) functions [3]. </p><p>It can be shown that for any positive integer <span>$m$</span> the space <span>$H^m_\varepsilon (R^n)$</span> consists of all square integrable functions whose derivatives in the sense of distributions up to order m are square integrable [3]. The norm on <span>$H^m_\varepsilon (R^n)$</span> can be defined by</p><div>\[\| \varphi \|&#39; = \left( \int \Big [ \varepsilon^2 | \varphi (x) |^2  + \sum_{|\alpha| = m} \frac{m!}{\alpha!} |D^\alpha \varphi (x) |^2 \Big ]
  \, d x \ 
 \right)^{1/2}  .\]</div><p>The corresponding inner product has the form</p><div>\[\langle \varphi , \psi \rangle&#39; =
\left( \int \Big [ \varepsilon^2 \varphi (x) \overline{\psi (x)}  + \sum_{|\alpha| = m} \frac{m!}{\alpha!} D^\alpha \varphi (x) \overline{D^\alpha \psi (x)}  \Big ]
  \, d x \ 
 \right)^{1/2} ,
 ```
here ``\alpha = (\alpha_1, \dots, \alpha_n )`` is multi-index with nonnegative integral
entries, ``|\alpha| = \alpha_1 + \dots + \alpha_n \ ``, ``\alpha ! = \alpha_1 ! \dots \alpha_n !`` and ``D^\alpha \varphi (x) = \frac{ \partial^{|\alpha|}{\varphi} }{ \partial{x_1^{\alpha_1}} \dots x_n^{\alpha_n}}``.

The norms ``\| \varphi \|`` and ``\| \varphi \|&#39;`` are equivalent and space ``H^m_\varepsilon (R^n)`` coincides with Sobolev space. 

 Hilbert space ``H^s_\varepsilon (R^n)`` is continuously embedded in Hölder space ``C_b^r(R^n)`` ([3],[17],[20]) of functions continuous and bounded with their first ``r`` derivatives, it means function ``f`` can be treated as an element of function class ``C^r(R^n)`` of functions continuous with their first ``r`` derivatives. Therefore functionals ``F_i`` and ``F&#39;_j``
\]</div><p>math \begin{aligned}   &amp; F<em>i(\varphi) = \varphi (p</em>i) \, , \ \ F&#39;<em>j(\varphi) = \frac{ \partial{\varphi} }{ \partial{e</em>j} }(s<em>j) \, , \ \ \forall \varphi \in H^s</em>\varepsilon (R^n) \, ,    \quad    p<em>i, \, s</em>j \in R^n \, ,    \
  &amp; i = 1, 2, \dots, n<em>1 \, , \ \   j = 1, 2, \dots, n</em>2 \, , \end{aligned}</p><pre><code class="language-none">are linear continuous functionals in ``H^s_\varepsilon``.

We also assume that all points ``\{p_i\}`` are different and in a case when among points ``\{s_j\}`` there are coincident ones, we stipulate that the corresponding unit vectors defining the directions of the directional derivatives at such points are linearly independent. Note that some points ``\{p_i\}`` may coincide with some ``\{s_j\}``. Under these restrictions all functionals $F_i, \, F&#39;_j$ are linearly independent.

 In accordance with Riesz representation theorem [1] these linear continuous functionals can be represented in the form of inner product of some elements ``h_i, h&#39;_j \in H^s_\varepsilon`` and ``\varphi \in H^s_\varepsilon``, for any ``\varphi \in H^s_\varepsilon``:
</code></pre><p>math \begin{aligned}  F<em>i(\varphi) = {\langle h</em>i,  \varphi \rangle} \, ,  \quad  F&#39;<em>j(\varphi) = {\langle h&#39;</em>j,  \varphi \rangle} \, ,  \quad  \forall \varphi \in H^s<em>\varepsilon \, , \  i = 1, 2, \dots, n</em>1 \, , \ \  j = 1, 2, \dots, n_2 \, . \end{aligned}</p><pre><code class="language-none">Elements ``h_i`` and ``h&#39;_j`` are continuously differentiable functions. Thereby the original system of constraints (1) can be written in form:
</code></pre><p>math \tag{2} \begin{aligned} &amp; f(p<em>i) = F</em>i(f) = {\langle h<em>i,  f \rangle}  = u</em>i \, , \
&amp; \frac{ \partial{f} }{ \partial{e<em>j} }(s</em>j) = F&#39;<em>j(f) = {\langle h&#39;</em>j,  f \rangle} = v<em>j \, ,    \
 &amp;  h</em>i, \, h&#39;<em>j, \, f \in H^s</em>\varepsilon \, ,  \quad   i = 1, 2, \dots, n<em>1 \, , \ \  j = 1, 2, \dots, n</em>2 \, .  \end{aligned}</p><pre><code class="language-none">here all functions ``h_i`` and ``h&#39;_j`` are linear independent and system of constrains (2) defines a nonempty convex and closed set (as an intersection of hyper-planes) in the Hilbert space ``H^s_\varepsilon``.

Problem of reconstruction of function ``f`` satisfying system of constraints (2) is undetermined. We reformulate it as a problem of finding solution of this system of constraints that has minimal norm:
</code></pre><p>math \tag{3}    \sigma = {\rm arg\,min}{  \| f - z \|^2 : (2), z \in H^s<em>\varepsilon , \forall f \in H^s</em>\varepsilon } \, ,</p><pre><code class="language-none">where ``z \in H^s_\varepsilon`` is a &quot;prototype&quot; function. Solution of this problem exists and it is unique ([6], [16]) as a projection of element ``z`` on the nonempty convex closed set in Hilbert space ``H^s_\varepsilon``. Element ``\sigma`` is an interpolating normal spline.

In accordance with generalized Lagrange method ([13], [16]) solution of the problem (3) can be presented as:
</code></pre><p>math \tag{4} \sigma =  z + \sum <em>{i=1}^{n</em>1} \mu<em>i  h</em>i  + \sum <em>{j=1}^{n</em>2} \mu&#39;<em>j  h&#39;</em>j  \, ,</p><pre><code class="language-none">where coefficients ``\mu_i`` and ``\mu&#39;_j`` are defined by system of linear equations
</code></pre><p>math \begin{aligned} \tag{5}     &amp; \sum <em>{l=1}^{n</em>1} g<em>{il} \mu</em>l + \sum <em>{j=1}^{n</em>2} g&#39;<em>{ij} \mu&#39;</em>j   =  u<em>i - {\langle h</em>i,  z \rangle} \, , \quad 1 \le i \le n<em>1 \, ,      \
    &amp; \sum _{i=1}^{n</em>1} g&#39;<em>{ij} \mu</em>i + \sum <em>{m=1}^{n</em>2} g&#39;&#39;<em>{jm} \mu&#39;</em>m\ =  v<em>j - {\langle h&#39;</em>j,  z \rangle}  \, , \quad 1 \le j \le n_2 \, , \end{aligned}    </p><pre><code class="language-none">Matrix of system (5) is the positive definite symmetric Gram matrix of the set of linearly independent elements  ``\{h_i\}, \{h&#39;_j\}`` and coefficients ``g_{il}, g&#39;_{ij}, g&#39;&#39;_{jm}`` are defined as follows:
</code></pre><p>math \tag{6}    g<em>{il} = {\langle h</em>i,  h<em>l \rangle} \, , \ \ g&#39;</em>{ij} = {\langle h<em>i,  h&#39;</em>j \rangle} \, , \ \  g&#39;&#39;<em>{jm} = {\langle h&#39;</em>j,  h&#39;_m \rangle} \, .</p><pre><code class="language-none">
Space ``H^s_\varepsilon (R^n)`` is a reproducing kernel Hilbert space ([5],[18],[19],[20]). We denote its reproducing kernel as ``V(\eta, \xi)``.

Recall the definition of the reproducing kernel ([4], [7]). The reproducing kernel of space ``H^s_\varepsilon`` is a such function ``V(\eta, \xi)`` that

* for every ``\xi \in R^n``, ``\ V(\eta, \xi)`` as function of ``\eta`` belongs to ``H^s_\varepsilon``
* for every ``\xi \in R^n`` and every function ``\varphi \in H^s_\varepsilon``
</code></pre><p>math \tag{7} \varphi(\xi) = {\langle V(\eta, \xi),  \varphi(\eta) \rangle}</p><pre><code class="language-none">Reproducing kernel is a symmetric function:
</code></pre><p>math V(\eta, \xi) = V(\xi, \eta) \, ,</p><pre><code class="language-none">also in the considered case (``s = n/2 + 1/2 + r, \, r \ge 1``) it is a continuously differentiable function. Differentiating the identity (7) allows to get the identities for derivatives:
</code></pre><p>math \tag{8} \frac {\partial \varphi(\xi)}{\partial \xi<em>k} = {\left \langle \frac{\partial V(\cdot, \xi)} {\partial \xi</em>k}, \varphi \right \rangle}</p><pre><code class="language-none">which holds for any ``\varphi \in H^s_\varepsilon`` and ``\xi \in R^n``, it means that function ``\frac{\partial {V(\cdot , \xi)} }{\partial{\xi_k}}`` represents a point-wise functional defined as value of function ``\frac{ \partial {\varphi (\cdot)} }{\partial{\xi_k}}`` at the point ``\xi``.

Now it is possible to express functions ``h_i`` and ``h&#39;_j`` via the reproducing kernel ``V``. Comparing (2) with (7) and (8) we receive:
</code></pre><p>math \tag{9} \begin{aligned} &amp;  h<em>i (\eta) =  V(\eta, p</em>i) \, ,  \qquad \qquad \qquad \qquad \qquad \ \ i = 1, 2, \dots, n<em>1 \, \   &amp;  h&#39;</em>j (\eta) =  \frac{\partial V(\eta, s<em>j)}{\partial e</em>j} =  \sum<em>{k=1}^n  \frac{ \partial {V(\eta, s</em>j)} }{\partial{\xi<em>k}} e</em>{jk}  \, , \quad  j = 1, 2, \dots, n_2 \ .   \end{aligned}</p><pre><code class="language-none">The coefficients (6) of the Gram matrix can be presented as ([7], [8], [10]):
</code></pre><p>math \tag{10} \begin{aligned}    &amp; g<em>{il} = {\langle h</em>i,  h<em>l \rangle} = {\langle V(\cdot, p</em>i),  V(\cdot, p<em>l) \rangle} = V(p</em>i, p<em>l) \, ,    \
    &amp; g&#39;</em>{ij} = {\langle h<em>i,  h&#39;</em>j \rangle} = {\left \langle V(\cdot, p<em>i), \frac{\partial V(\cdot, s</em>j)}{\partial e<em>j} \right \rangle} =  \frac{\partial V(p</em>i, s<em>j)}{\partial e</em>j} =     \
    &amp; \qquad \qquad \qquad =  \sum<em>{k=1}^n  \frac{ \partial {V(p</em>i, s<em>j)} }{\partial{\xi</em>k}} e_{jk}  \ . \end{aligned}</p><pre><code class="language-none">With the help of (7) and (10), we can also calculate ``g&#39;&#39;_{jm}`` ([8], [10]):
</code></pre><p>math \tag{11} \begin{aligned}  g&#39;&#39;<em>{jm} = {\langle h&#39;</em>j,  h&#39;<em>m \rangle} \, &amp; = \, {\left \langle \frac{\partial V(\cdot, s</em>j)}{\partial e<em>j}, \frac{\partial V(\cdot, s</em>m)}{\partial e<em>m} \right \rangle} \,  = \, \frac {\partial^2 V(s</em>j, s<em>m)} {\partial e</em>j \partial e<em>m} =  \
 &amp;  =  \sum</em>{r=1}^n \sum<em>{k=1}^n  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>k}} e</em>{jk} e_{mr} \ . \end{aligned}</p><pre><code class="language-none">Further
</code></pre><p>math \tag{12} \begin{aligned}   &amp; {\langle h<em>i,  z \rangle}  =  {\langle V(\cdot, p</em>i),  z \rangle} = z(p<em>i)  \, ,   \
  &amp; {\langle h&#39;</em>j,  z \rangle}  = \frac{\partial z(s<em>j)}{\partial e</em>j} = \sum<em>{k=1}^n  \frac{ \partial {z(s</em>j)} }{\partial{x<em>k}} e</em>{jk} \, . \end{aligned}</p><pre><code class="language-none">
Here normal hermite splines will be constructed in Bessel Potential spaces ``H^{s_1}_\varepsilon (R^n) , \, s_1 = n/2 + 3/2`` and ``H^{s_2}_\varepsilon (R^n) , \, s_2 = n/2 + 5/2``. Elements of space ``H^{s_1}`` can be treated as  continuously differentiable functions and elements of space ``H^{s_2}`` can be treated as twice continuously differentiable functions. Note, the spline is infinitely differentiable everywhere in ``R^n`` excepting the nodes ``p_i`` and ``s_j``.

Reproducing kernel of Bessel Potential space was presented in [5] and its simplified form was given in [14], [18], [19], [20]. For space ``H^{s}_\varepsilon (R^n), \, s = n/2 + 1/2 + r, \, r \ge 0`` it can be written as:
</code></pre><p>math  V(\eta , \xi) = \exp (-\varepsilon |\eta - \xi|) \,      \sum_{k=0}^{r} \frac{(r+k)!}{2^k k! (r-k)!} (\varepsilon |\eta - \xi|)^{r-k} \ ,</p><pre><code class="language-none">``(``a constant multiplier is omitted here.``)``

This reproducing kernel is known as the Matérn kernel [23].

Therefore for space ``H^{s_1}_\varepsilon (R^n)`` with accuracy to constant multiplier we get:
</code></pre><p>math \tag{13} V(\eta, \xi) =  \exp (-\varepsilon |\eta - \xi|)              (1 + \varepsilon |\eta - \xi|) \, .</p><pre><code class="language-none">and for space ``H^{s_2}_\varepsilon (R^n)``:</code></pre><p>math \tag{14} V(\eta, \xi) =  \exp (-\varepsilon |\eta - \xi|)              (3 + 3\varepsilon |\eta - \xi| + \varepsilon ^2 |\eta - \xi| ^2 ) \, .</p><pre><code class="language-none">Let&#39;s write down expressions of ``h_i, h&#39;_j, g_{il}, g&#39;_{ij}, g&#39;&#39;_{jm}`` for space ``H^{s_1}_\varepsilon (R^n)``:
</code></pre><p>math \tag{15} \begin{aligned} &amp; h<em>i (\eta) =  \exp (-\varepsilon |\eta - p</em>i |) (1 + \varepsilon |\eta - p<em>i|) \, , \qquad  \quad \  i = 1, 2, \dots, n</em>1 \, , \
&amp; h&#39;<em>j (\eta) = \varepsilon^2 \exp (-\varepsilon | \eta - s</em>j | ) \sum <em>{k=1}^n (\eta</em>k - s<em>{jk}) e</em>{jk} \, , \quad  j = 1, 2, \dots, n<em>2 \, , \
&amp; g</em>{il}= \exp (-\varepsilon | p<em>i - p</em>l | )(1 + \varepsilon | p<em>i - p</em>l | ) \, ,    \quad  \ \  i = 1, 2, \dots, n<em>1 \, , \ \ l = 1, 2, \dots, n</em>1 \, , \
&amp; g&#39;<em>{ij} = \varepsilon^2 \exp (-\varepsilon |p</em>i - s<em>j | ) \sum _{k=1}^n (p</em>{ik} - s<em>{jk}) e</em>{jk}  \, , \ \ i = 1, 2, \dots, n<em>1 \, , \ \ j = 1, 2, \dots, n</em>2 \, , \
&amp; g&#39;&#39;<em>{jm} =  \sum</em>{r=1}^n \sum<em>{k=1}^n  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>k}} e</em>{jk} e<em>{mr} \
&amp; \quad \qquad j \ne m \, , \quad j = 1, 2, \dots, n</em>2 \, , \ \ m = 1, 2, \dots, n<em>2 \, , \
&amp; \text{where} \
&amp;  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>r}} = \varepsilon^2 \exp (-\varepsilon | s</em>j - s<em>m |) \left (1 - \varepsilon \frac {(s</em>{jr} - s<em>{mr})^2}{| s</em>j - s<em>m |} \right) \, , \
&amp;  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>k}} = -\varepsilon^3 \exp (-\varepsilon | s</em>j - s<em>m |) \frac {(s</em>{jr} - s<em>{mr})(s</em>{jk} - s<em>{mk})}{| s</em>j - s<em>m |} \, ,  \quad r \ne k \, , \
&amp; g&#39;&#39;</em>{jj} = \varepsilon^2 \sum <em>{r=1}^n\  (e</em>{jr})^2  = \varepsilon^2 \,  , \quad j = 1, 2, \dots, n_2 \, , \end{aligned}</p><pre><code class="language-none">and for space ``H^{s_2}_\varepsilon (R^n)``:
</code></pre><p>math \tag{16} \begin{aligned} &amp; h<em>i (\eta) =  \exp (-\varepsilon |\eta - p</em>i |) (3 + 3 \varepsilon |\eta - p<em>i | +  \varepsilon^2  |\eta - p</em>i |^2) )  \, , \qquad \quad i = 1, 2, \dots, n<em>1 \, , \
&amp; h&#39;</em>j (\eta) =\varepsilon^2 \exp (-\varepsilon |\eta - s<em>j | ) (1 + \varepsilon |\eta - s</em>j |) \sum <em>{k=1}^n (\eta</em>k - s<em>{jk}) e</em>{jk} \, , \quad  j = 1, 2, \dots, n<em>2 \, , \
&amp; g</em>{il}= \exp (-\varepsilon |p<em>i - p</em>l |) (3 + 3 \varepsilon |p<em>i - p</em>l | +  \varepsilon^2  |p<em>i - p</em>l |^2) ) \, , \
&amp; \qquad \qquad \qquad \qquad \qquad \qquad \qquad i = 1, 2, \dots, n<em>1 \, , \ \ l = 1, 2, \dots, n</em>1 \, , \
&amp; g&#39;<em>{ij} = \varepsilon^2 \exp (-\varepsilon |p</em>i - s<em>j | ) (1 + \varepsilon |p</em>i - s<em>j |) \sum _{k=1}^n (p</em>{ik} - s<em>{jk}) e</em>{jk}  \, , \
&amp; \qquad \qquad \qquad \qquad \qquad \qquad \qquad  i = 1, 2, \dots, n<em>1 \, , \ \ j = 1, 2, \dots, n</em>2 \, , \
&amp; g&#39;&#39;<em>{jm} =  \sum</em>{r=1}^n \sum<em>{k=1}^n  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>k}} e</em>{jk} e<em>{mr} \
&amp; \quad \qquad j \ne m \, , \quad j = 1, 2, \dots, n</em>2 \, , \ \ m = 1, 2, \dots, n<em>2 \, , \
&amp; \text{where} \
&amp;  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>r}} = \varepsilon^2 \exp (-\varepsilon | s</em>j - s<em>m |) (1 + \varepsilon | s</em>j - s<em>m | - \varepsilon^2 (s</em>{jr} - s<em>{mr})^2) \, , \
&amp;  \frac{ \partial^2 {V(s</em>j, s<em>m)} }{\partial{\eta</em>r} \partial{\xi<em>k}} = -\varepsilon^4 \exp (-\varepsilon | s</em>j - s<em>m |) (s</em>{jr} - s<em>{mr})(s</em>{jk} - s<em>{mk}) \, ,  \quad r \ne k \, , \
&amp; g&#39;&#39;</em>{jj} = \varepsilon^2 \sum <em>{r=1}^n\  (e</em>{jr})^2  = \varepsilon^2 \,  , \quad j = 1, 2, \dots, n_2 \, , \end{aligned}</p><pre><code class="language-none">
In a case when there is no information of function ``f`` derivatives the Problem ``(1)`` is reducing to the simplest interpolation problem:

*Problem:* Given points ``\{p_i, p_i \in R^n\}_{i=1}^{n_1}`` find a function ``f`` such that
</code></pre><p>math \tag{17} \begin{aligned} &amp; f(p<em>i) =  u</em>i \, , \quad  i = 1, 2, \dots, n<em>1 \, , \
&amp; n</em>1 \gt 0 \, . \end{aligned}</p><pre><code class="language-none">We assume that ``f`` is a continuous function. It can be treated as an element of Bessel Potential space ``H_\varepsilon^{s_0} (R^n) \, , s_0 =  n/2 + 1/2``, this space is continuously embedded in Hölder space ``C_b(R^n)`` of continuous and bounded functions.

Reproducing kernel of Bessel Potential space ``H_\varepsilon^{s_0}(R^n)``
can be written as:
</code></pre><p>math V(\eta , \xi) = \exp (-\varepsilon |\eta - \xi|) \, .</p><pre><code class="language-none">``(``with accuracy to a constant multipliler``)``, and expressions for $h_i, g_{il}$ are defined by:
</code></pre><p>math \tag{18} \begin{aligned} &amp; h<em>i (\eta) = \exp (-\varepsilon |\eta - p</em>i |) \, , \quad  i = 1, 2, \dots, n<em>1 \, ,  \
&amp; g</em>{il} = \exp (-\varepsilon | p<em>i - p</em>l | )) \ ,  \ \quad i = 1, 2, \dots, n<em>1 \, , \ \ l = 1, 2, \dots, n</em>1 \, . \end{aligned} ```</p><p>When value of the parameter <span>$\varepsilon$</span> is small this normal spline is similar to multivariate generalization of the one dimensional linear spline.</p><p>We now consider the choice of value for parameter <span>$\varepsilon$</span>. Approximating properties of the normal spline are getting better with smaller value of <span>$\varepsilon$</span>, and if the value of this parameter is small enough the normal spline become similar to Duchon&#39;s <span>$D^m -$</span>spline [12]. However with decreasing value of <span>$\varepsilon$</span> the condition number of the corresponding problem Gram matrix is increasing and the problem becomes numerically unstable. Therefore, when choosing the value of parameter <span>$\varepsilon$</span>, a compromise is needed. In practice, it is necessary to choose such value of the <span>$\varepsilon$</span> that condition number of Gram matrix is small enough. Numerical procedures of the matrix condition number estimation are well known.</p><p>As well, it is useful to preprocess the source data of the problem by transforming the domain where interpolation nodes are located into the unit hypercube.</p><p>The normal splines method for one-dimensional function interpolation and linear ordinary differential and integral equations was proposed in [8] and [9] and developed in [10]. Multivariate generalization of the normal splines method was developed for two-dimensional problem of low-range computerized tomography in [15] and applied for solving a mathematical economics problem in [11]. Further results were reported on seminars and conferences [14,21,22].</p><p><strong>References</strong></p><p>[1]  R. Adams, J. Fournier, Sobolev Spaces. Pure and Applied Mathematics. (2nd ed.). Boston, MA: Academic Press, 2003.</p><p>[2] D. Adams, L. Hedberg, Function spaces and potential theory. Berlin, Springer, 1996.</p><p>[3] M. Agranovich, Sobolev Spaces, Their Generalizations and Elliptic Problems in Smooth and Lipschitz Domains, Springer, Switzerland, 2015.</p><p>[4] N. Aronszajn, Theory of reproducing kernels, Tranzactions of the AMS, Vol. 68, No. 3, 1950.</p><p>[5] N. Aronszajn, K.T. Smith, Theory of bessel potentials I, Ann.Inst.Fourier, Vol. 11, 1961.</p><p>[6] A. Balakrishnan, Applied Functional Analysis, New York, Springer-Verlag, 1976.</p><p>[7] A. Bezhaev, V. Vasilenko, Variational Theory of Splines, Springer US, 2001.</p><p>[8] V. Gorbunov, The method of normal spline collocation, USSR Computational Mathematics and Mathematical Physics, Vol. 29, No. 1, 1989.</p><p>[9] V. Gorbunov, Extremum Problems of Measurements Data Processing, Ilim, 1990 (in Russian).</p><p>[10] V. Gorbunov, V. Petrishchev, Improvement of the normal spline collocation method for linear differential equations, Comput. Math. Math. Phys., Vol. 43, No. 8, 2003.</p><p>[11] V. Gorbunov, I. Kohanovsky, K. Makedonsky, Normal splines in reconstruction of multi-dimensional dependencies. <a href="http://www.wseas.us/e-library/conferences/corfu2004/papers/488-312.pdf">Papers of WSEAS International Conference on Applied Mathematics, Numerical Analysis Symposium, Corfu, 2004</a></p><p>[12] J. Duchon, Splines minimizing rotation-invariant semi-norms in Sobolev spaces, Lect. Notes in Math., Springer, Berlin, Vol. 571, 1977.</p><p>[13] A. Ioffe, V. Tikhomirov, Theory of extremal problems, North-Holland, Amsterdam, 1979.</p><p>[14] I. Kohanovsky, Multidimensional Normal Splines and Problem of Physical Field Approximation, International Conference on Fourier Analysis and its Applications, Kuwait, 1998.</p><p>[15] I. Kohanovsky, Normal Splines in Computing Tomography, <a href="https://www.iae.nsk.su/images/stories/5_Autometria/5_Archives/1995/2/84-89.pdf">Avtometriya, No.2, 1995</a></p><p>[16] P.-J. Laurent, Approximation et optimization, Paris, 1972.</p><p>[17] H. Triebel, Interpolation. Function Spaces. Differential Operators. North-Holland, Amsterdam, 1978.</p><p>[18] R. Schaback, Kernel-based Meshless Methods, Lecture Notes, Goettingen, 2011.</p><p>[19] H. Wendland, Scattered Data Approximation. Cambridge University Press, 2005.</p><p>[20] <a href="https://igorkohan.github.io/NormalHermiteSplines.jl/stable/Reproducing-Kernel-of-Bessel-Potential-space">Reproducing Kernel of Bessel Potential space</a>.</p><p>[21] V. Gorbunov, I. Kohanovsky, Heterogeneous Parallel Method for the Construction of Multi-dimensional Smoothing Splines. <a href="https://www.ana.iusiani.ulpgc.es/proyecto2015-2017/pdfnew/ESCO2014_Book_of_Abstracts.pdf">ESCO 2014 4th European Seminar on Computing, 2014</a></p><p>[22] I. Kohanovsky, Inequality-Constrained Multivariate Normal Splines with Some Applications in Finance. <a href="https://www.ana.iusiani.ulpgc.es/proyecto2015-2017/pdfnew/ESCO2014_Book_of_Abstracts.pdf">27th GAMM-Seminar Leipzig on Approximation of Multiparametric functions, 2011</a></p><p>[23] G. Fasshauer, M. McCourt, Kernel-Based Approximation Methods Using Matlab, World Scientific, Singapore, 2015.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Reproducing-Kernel-of-Bessel-Potential-space/">« Reproducing Kernel of Bessel Potential space</a><a class="docs-footer-nextpage" href="../Simple-examples/">Simple Normal Splines Examples »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 18 September 2020 06:28">Friday 18 September 2020</span>. Using Julia version 1.5.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
